@model Zamowienie

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-warning alert-dismissible fade show text-center" role="alert">
        <strong>@TempData["ErrorMessage"]</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show text-center" role="alert">
        <strong>@TempData["SuccessMessage"]</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<style>
    /* Stronger selector and !important to override Bootstrap */
    div.card {
    background-color: #444444 !important;
    border: none;
    border-radius: 10px;
    color: white;
    }

    div.card-header {
    background-color: #1a237e !important;
    color: white !important;
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    text-align: center;
    padding: 1rem;
    }

    div.card-header h3 {
    color: white !important;
    margin: 0;
    }

    div.card-body {
    background-color: #444444 !important;
    border-bottom-left-radius: 10px;
    border-bottom-right-radius: 10px;
    padding: 1rem;
    }

    /* Table tbody cells with dark gray background and white text */
    table.table tbody tr td {
    background-color: #6c757d !important; /* Bootstrap bg-secondary color */
    color: white !important;
    }

    /* Keep image thumbnail background transparent */
    table.table tbody tr td img.img-thumbnail {
    background-color: transparent;
    }
</style>

<div class="container mt-4">
    <div class="card shadow-lg border-0">
        <div class="card-header">
            <h3>Szczegóły zamówienia</h3>
        </div>
        <div class="card-body">
            <p><strong>Data zamówienia:</strong> @Model.DataZamowienia.ToString("dd-MM-yyyy HH:mm")</p>
            <p><strong>Adres dostawy:</strong> @Model.Ulica @Model.NumerBudynku, @Model.KodPocztowy @Model.Miejscowosc</p>
            <p><strong>Przewidywany czas realizacji:</strong> @Model.PrzewidywanyCzasRealizacji min</p>
            <p><strong>Cena całkowita:</strong> @Model.CenaCalkowita.ToString("C")</p>
            @if(Model.SposobDostawy)
            {
                <p><strong>Sposób dostawy:</strong> Dostawa</p>
            }
            else
            {
                <p><strong>Sposób dostawy:</strong> Odbiór osobisty</p>
            }
            <p>
                <strong>Status:</strong>
                @if (Model.Status == 0)
                {
                    <span class="text-warning">Anulowane</span>
                }
                else if (Model.Status == 1)
                {
                    <span class="text-info">Złożone</span>
                }
                else if (Model.Status == 2)
                {
                    <span class="text-primary">W przygotowaniu</span>
                }
                else if (Model.Status == 3)
                {
                    if(Model.SposobDostawy)
                    {
                        <span class="text-success">W dostawie</span>
                    }
                    else
                    {
                        <span class="text-success">Gotowe do odbioru</span>
                    }
                }
                else if (Model.Status == 4)
                {
                    <span class="text-success">Zrealizowane</span>
                }
            </p>
            @if (Model.Opinia != null)
            {
                <p><strong>Opinia: </strong>@Model.Opinia.Ocena - @Model.Opinia.Komentarz</p>
            }
            @if (Model.Status == 1)
            {
                <a asp-action="CancelOrder" asp-route-id="@Model.Id" class="btn btn-danger text-white">Anuluj zamówienie</a>
            }
            else if (Model.Status == 4 && Model.Opinia == null)
            {
                <a asp-action="AddReview" asp-route-ZamowienieId="@Model.Id" class="btn btn-success text-white">Oceń zamówienie</a>
            }
            <a asp-action="ReOrder" asp-route-id="@Model.Id" class="btn btn-info text-white">Zamów ponownie</a>
        </div>
    </div>

    <h3 class="text-center text-white mt-4">Zamówione produkty</h3>
    <table class="table table-bordered table-striped">
        <thead class="bg-dark text-white">
            <tr>
                <th>Nazwa</th>
                <th>Opis</th>
                <th>Cena</th>
                <th>Czas przygotowania</th>
                <th>Kategoria</th>
                <th>Zdjęcie</th>
                <th>Ilość</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var produkt in Model.ZamowioneProdukty)
            {
                <tr>
                    <td>@produkt.Produkt.Nazwa</td>
                    <td>@produkt.Produkt.Opis</td>
                    <td>@produkt.Produkt.Cena.ToString("C")</td>
                    <td>@produkt.Produkt.CzasPrzygotowania min</td>
                    <td>@produkt.Produkt.Kategoria.Nazwa</td>
                    <td>
                        @if (!string.IsNullOrEmpty(produkt.Produkt.Zdjecie))
                        {
                            <img src="@produkt.Produkt.Zdjecie" alt="Zdjęcie produktu" class="img-thumbnail" style="width: 100px;" />
                        }
                        else
                        {
                            <span class="text-white">Brak zdjęcia</span>
                        }
                    </td>
                    <td>@produkt.Ilosc</td>
                </tr>
            }
        </tbody>
    </table>
</div>
